Une fois docker-compose.yml exécuté, il faudrait copier les drivers dans le conteneur de MariaDB:

sudo docker cp drivers/mariadb-java-client-3.5.0.jar nifis:/opt/nifi/nifi-current/lib


Ensuite connectez vous au conteneur MariaDB pour créer le schéma Amerique ainsi que la base de données Meteo associée pour notre exemple:

docker exec -it mariadbs mariadb -u root -p


CREATE TABLE IF NOT EXISTS Meteo.Amerique (
    ID INT PRIMARY KEY,
    Temperature FLOAT,
    Pressure INT,
    Humidity INT,
    Date DATE,
    Location VARCHAR(255)
);


Pour permettre à l'utilisateur de se connecter depuis une machine quelconque:

GRANT ALL PRIVILEGES ON Meteo.* TO 'nifi_user'@'%' IDENTIFIED BY 'nifi_password';
FLUSH PRIVILEGES;


Connectez vous à l'instance de nifi:

https://localhost:8443/nifi/

Puis chargez le template, démarrez le service maria DBCPConnectionPool et exécutez le flux de données du template:

test_maria_sb.xml

Normalement des tuples sont ajoutés dans la table Amerique de la base de données Meteo.



